var userConsent,__extends,UserConsentModule;(function(n){var t,i;(function(n){n[n.None=0]="None";n[n.EnableFavourites=1]="EnableFavourites"})(t=n.ConsentFeatures||(n.ConsentFeatures={})),function(n){n[n.None=0]="None";n[n.StrictlyNecessary=1]="StrictlyNecessary";n[n.Performance=2]="Performance";n[n.Functional=4]="Functional";n[n.Marketing=8]="Marketing"}(i=n.ConsentCategoryTypes||(n.ConsentCategoryTypes={}))})(UserConsentModule||(UserConsentModule={})),function(n){var t=function(){function t(){this.consentPreferences={};this.consentFeatures=[];this.userConsentConstants={OPTANON_COOKIE_NAME:"OptanonConsent",GROUPS_SECTION_NAME:"groups",STRICTLY_NECESSARY_CATEGORY:"StNec",FUNCTIONAL_CATEGORY:"Funct",PERFORMANCE_CATEGORY:"Perf",MARKETING_CATEGORY:"Targt",ONSITE_MARKETING_CATEGORY:"Ontgt"};this.loadConsentPreferences()}return Object.defineProperty(t.prototype,"consentFeaturesCollection",{get:function(){return this.consentFeatures},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isStrictlyNecessaryAllowed",{get:function(){return this.getUserConsentPreferenceFor(n.ConsentCategoryTypes.StrictlyNecessary)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFunctionalAllowed",{get:function(){return this.getUserConsentPreferenceFor(n.ConsentCategoryTypes.Functional)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPerformanceAllowed",{get:function(){return this.getUserConsentPreferenceFor(n.ConsentCategoryTypes.Performance)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMarketingAllowed",{get:function(){return this.getUserConsentPreferenceFor(n.ConsentCategoryTypes.Marketing)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isUserConsentManagementFeatureEnabled",{get:function(){return typeof Next!="undefined"?Next.Settings.Channel.UserConsentManagement.Enabled:!1},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.isUserConsentManagementFeatureEnabled&&(this.loadConsentPreferences(),this.consentFeatures.push(new n.FavouritesConsentFeature(this)))},t.prototype.optanonResetHistoricalOffsiteExists=function(){return document.cookie.indexOf("OptanonResetHistorical=")>-1||document.cookie.indexOf("OptanonResetHistoricalOffsite=")>-1},t.prototype.optanonResetHistoricalOnsiteExists=function(){return document.cookie.indexOf("OptanonResetHistorical=")>-1||document.cookie.indexOf("OptanonResetHistoricalOnsite=")>-1},t.prototype.consentDecisionHasBeenGiven=function(){return document.cookie.indexOf("OptanonAlertBoxClosed")>-1},t.prototype.getConsentCookieValue=function(n){var i,u,r,t;for(n===void 0&&(n=!1),i=this.userConsentConstants.OPTANON_COOKIE_NAME+"=",u=document.cookie.split(";"),r=0;r<u.length;r++){for(t=u[r];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(i)==0)return n?decodeURIComponent(t.substring(i.length,t.length).replace(/\+/g," ")):t.substring(i.length,t.length)}return""},t.prototype.sendConsentFeatureEnabledToDatalayer=function(n,t){t==null&&(t="TrackGTMEvent");window.firebase.push({event:t,isUserConsentFeatureEnabled:n})},t.prototype.sendConsentDatabaseEnabledToDatalayer=function(n,t){t==null&&(t="TrackGTMEvent");window.firebase.push({event:t,isUserConsentDatabaseEnabled:n})},t.prototype.loadConsentPreferences=function(){var e=this.getConsentCookieValue(!0),u,t,i,f,r,n;if(this.consentPreferences={isStrictlyNecessaryAllowed:!0,isFunctionalAllowed:!0,isPerformanceAllowed:!0,isMarketingAllowed:!this.optanonResetHistoricalOffsiteExists(),isOnsiteMarketingAllowed:!this.optanonResetHistoricalOnsiteExists()},e.length>0)for(u=e.split("&"),t=0;t<u.length;t++)if(i=u[t].split("="),i[0]===this.userConsentConstants.GROUPS_SECTION_NAME&&i[1].length>0)for(f=i[1].split(","),r=0;r<f.length;r++)if(n=f[r].split(":"),n!==undefined&&n.length>0)switch(n[0]){case this.userConsentConstants.STRICTLY_NECESSARY_CATEGORY:this.consentPreferences.isStrictlyNecessaryAllowed=n[1]==="1"?!0:!1;break;case this.userConsentConstants.FUNCTIONAL_CATEGORY:this.consentPreferences.isFunctionalAllowed=n[1]==="1"?!0:!1;break;case this.userConsentConstants.PERFORMANCE_CATEGORY:this.consentPreferences.isPerformanceAllowed=n[1]==="1"?!0:!1;break;case this.userConsentConstants.MARKETING_CATEGORY:this.consentPreferences.isMarketingAllowed=this.optanonResetHistoricalOffsiteExists()?!1:n[1]==="1"?!0:!1;break;case this.userConsentConstants.ONSITE_MARKETING_CATEGORY:this.consentPreferences.isOnsiteMarketingAllowed=this.optanonResetHistoricalOnsiteExists()?!1:n[1]==="1"?!0:!1}},t.prototype.reevaluateConsentFeatures=function(){var n=this.consentPreferences,t,r,i;this.loadConsentPreferences();var u=n.isFunctionalAllowed!=this.isFunctionalAllowed&&this.isFunctionalAllowed,f=n.isPerformanceAllowed!=this.isPerformanceAllowed&&this.isPerformanceAllowed,e=n.isMarketingAllowed!=this.isMarketingAllowed&&this.isMarketingAllowed,o=n.isFunctionalAllowed!=this.isFunctionalAllowed||n.isPerformanceAllowed!=this.isPerformanceAllowed||n.isMarketingAllowed!=this.isMarketingAllowed;if(this.consentFeatures&&o)for(t=0,r=this.consentFeatures;t<r.length;t++)i=r[t],i.consentChannelFeature.IsConsentEnabled&&(u||f||e?i.reEnableFeature(this):i.disableFeature(this))},t.prototype.isConsentFeatureAllowed=function(n){var t,r,i;if(this.consentFeaturesCollection&&this.consentFeaturesCollection.length>0)for(t=0,r=this.consentFeaturesCollection;t<r.length;t++)if(i=r[t],i.channelFeatureConsentFeature===n)return i.isConsentFeatureAllowed(this,i.consentChannelFeature);return!0},t.prototype.handleConsentFeatureClickEvent=function(n){var u,t,i,r;if(this.consentFeaturesCollection&&this.consentFeaturesCollection.length>0)for(this.loadConsentPreferences(),u=n.currentTarget.getAttribute("data-consent-category"),t=0,i=this.consentFeaturesCollection;t<i.length;t++)if(r=i[t],r.isMatchingConsentEvent(u)){r.applyUIEvent(this,n);return}},t.prototype.getUserConsentPreferenceFor=function(t){switch(t){case n.ConsentCategoryTypes.StrictlyNecessary:return this.consentPreferences.isStrictlyNecessaryAllowed;case n.ConsentCategoryTypes.Functional:return this.consentPreferences.isFunctionalAllowed;case n.ConsentCategoryTypes.Performance:return this.consentPreferences.isPerformanceAllowed&&this.consentDecisionHasBeenGiven();case n.ConsentCategoryTypes.Marketing:return this.consentPreferences.isMarketingAllowed&&this.consentDecisionHasBeenGiven();default:return!0}},t}();n.UserConsent=t}(UserConsentModule||(UserConsentModule={}));userConsent=new UserConsentModule.UserConsent;document.addEventListener("DOMContentLoaded",function(){userConsent.init()},!1);window.addEventListener("consent.onetrust",function(){document.readyState==="complete"&&userConsent.reevaluateConsentFeatures()},!1),function(n){var t=function(){function t(){this.userConsentUIPrefixConstants={STRICTLY_NECESSARY_PREFIX_IDENTIFIER:"strictly-necessary",FUNCTIONAL_PREFIX_IDENTIFIER:"functional",PERFORMANCE_PREFIX_IDENTIFIER:"performance",MARKETING_PREFIX_IDENTIFIER:"marketing"}}return t.prototype.getConsentFeatureKeyName=function(t){return""+n.ConsentFeatures[t].toLowerCase()},t.prototype.isConsentFeatureAllowed=function(n,t){return t&&t.IsConsentEnabled&&(!n.isFunctionalAllowed&&t.IsFunctionalConsentEnabled||!n.isPerformanceAllowed&&t.IsPerformanceConsentEnabled||!n.isMarketingAllowed&&t.IsMarketingConsentEnabled)?!1:!0},t.prototype.getFeatureInChannelConsentFeatures=function(n){if(Next&&Next.Settings.Channel.ConsentFeatures)for(var t=0;t<Next.Settings.Channel.ConsentFeatures.length;t++)if(this.getFeatureFor(Next.Settings.Channel.ConsentFeatures[t].ConsentFeature)===n)return Next.Settings.Channel.ConsentFeatures[t];return undefined},t.prototype.isMatchingConsentFeature=function(n,t){for(var i,u=this.getUIElementsConsentFeatures(n),r=0;r<u.length;r++)if(i=u[r].split("-"),i&&i.length>0&&this.getFeatureFor(i[i.length-1].valueOf())===t)return!0;return!1},t.prototype.showConsentPopup=function(n,t){t.stopPropagation();t.preventDefault();var i=document.getElementById("consent-popup");i&&(this.setupConsentPopupTitle(i,n),i.style.visibility="visible",i.style.display="block")},t.prototype.getUIElementsConsentFeatures=function(n){for(var t,r=[],u=n.split(";"),i=0;i<u.length;i++)t=u[i].trim(),t&&(t.indexOf(this.userConsentUIPrefixConstants.STRICTLY_NECESSARY_PREFIX_IDENTIFIER)>-1||t.indexOf(this.userConsentUIPrefixConstants.FUNCTIONAL_PREFIX_IDENTIFIER)>-1||t.indexOf(this.userConsentUIPrefixConstants.PERFORMANCE_PREFIX_IDENTIFIER)>-1||t.indexOf(this.userConsentUIPrefixConstants.MARKETING_PREFIX_IDENTIFIER)>-1)&&r.push(t);return r},t.prototype.getFeatureFor=function(t){for(var i in n.ConsentFeatures)if(i.toLowerCase()===t.toLowerCase())return n.ConsentFeatures[i];return undefined},t.prototype.setupConsentPopupTitle=function(n,t){for(var i,u=n.querySelectorAll(".consent-popup-title"),f="consent-popup-title-"+this.getConsentFeatureKeyName(t),e=u.length,r=0;r<e;r++)i=u[r],i&&i.id&&(i.id.toLowerCase()===f?(i.classList.remove("hidden"),i.classList.add("show")):(i.classList.add("hidden"),i.classList.remove("show")))},t}();n.BaseConsentFeature=t}(UserConsentModule||(UserConsentModule={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(i){var r=t.call(this)||this;return r.channelFeatureConsentFeature=n.ConsentFeatures.EnableFavourites,r.consentFeatures=t.prototype.getFeatureInChannelConsentFeatures.call(r,r.channelFeatureConsentFeature),r.init(i),r}return __extends(i,t),Object.defineProperty(i.prototype,"consentChannelFeature",{get:function(){return this.consentFeatures},enumerable:!0,configurable:!0}),i.prototype.init=function(n){this.isFeatureAndConsentFeatureAllowed(n,!1,!1)&&$(".FavouriteHeader, .favourite").click(function(t){t.stopPropagation();t.preventDefault();n.handleConsentFeatureClickEvent(t)})},i.prototype.isMatchingConsentEvent=function(n){return t.prototype.isMatchingConsentFeature.call(this,n,this.channelFeatureConsentFeature)},i.prototype.applyUIEvent=function(n,i){this.isFeatureAndConsentFeatureAllowed(n,!1,!1)&&t.prototype.showConsentPopup.call(this,this.channelFeatureConsentFeature,i)},i.prototype.reEnableFeature=function(n){this.isFeatureAndConsentFeatureAllowed(n,!0,!0)&&(NextFavourites.BindEvents(),NextFavourites.Load(),$(".FavouriteHeader, .favourite").off())},i.prototype.disableFeature=function(n){var i,u,t,r;if(this.isFeatureAndConsentFeatureAllowed(n,!1,!0))for(NextFavourites.BindEvents(),NextFavourites.Load(),NextFavourites.SetSessionStorageHasFavouriteItems(),i=document.querySelectorAll(".heart.remove"),u=i.length,t=0;t<u;t++)r=i[t],r.classList.remove("remove"),r.classList.add("add")},i.prototype.isFeatureAndConsentFeatureAllowed=function(n,i,r){return typeof Next!="undefined"&&Next.Settings.Channel.FavouritesEnabled&&t.prototype.isConsentFeatureAllowed.call(this,n,this.consentChannelFeature)===i&&(!r||typeof NextFavourites!="undefined")},i}(n.BaseConsentFeature);n.FavouritesConsentFeature=t}(UserConsentModule||(UserConsentModule={}));window.addEventListener("ONSITE_COOKIE_CONSENT_VALUE_CHANGED",function(n){typeof Next=="undefined"||Next.Settings.Channel.EnableModernisedHeader||(n.detail!=!0&&eraseCookie("MASId"),console.log("ONSITE_COOKIE_CONSENT_VALUE_CHANGED - MASId - "+n.detail))},!0)